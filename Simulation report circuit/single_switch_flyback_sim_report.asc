Version 4
SHEET 1 5945676 13421556
WIRE 2176 -80 2016 -80
WIRE 2608 -80 2176 -80
WIRE 2832 -80 2608 -80
WIRE 2016 -64 2016 -80
WIRE 2608 -32 2608 -80
WIRE 2608 -32 2560 -32
WIRE 2640 -32 2608 -32
WIRE 2176 -16 2176 -80
WIRE 2560 -16 2560 -32
WIRE 2832 -16 2832 -80
WIRE 2896 -16 2832 -16
WIRE 3104 -16 2960 -16
WIRE 3200 -16 3104 -16
WIRE 3376 -16 3264 -16
WIRE 3984 -16 3376 -16
WIRE 4032 -16 3984 -16
WIRE 2896 0 2896 -16
WIRE 2960 0 2960 -16
WIRE 2016 32 2016 16
WIRE 3104 32 3104 -16
WIRE 3376 64 3376 -16
WIRE 3984 64 3984 -16
WIRE 2560 80 2560 48
WIRE 2608 80 2560 80
WIRE 2640 80 2640 48
WIRE 2640 80 2608 80
WIRE 2608 96 2608 80
WIRE 2688 96 2608 96
WIRE 2896 96 2896 80
WIRE 2896 96 2752 96
WIRE 2176 112 2176 64
WIRE 2256 112 2176 112
WIRE 2368 112 2336 112
WIRE 2176 208 2176 112
WIRE 2352 208 2176 208
WIRE 2480 208 2352 208
WIRE 2656 208 2544 208
WIRE 2896 208 2656 208
WIRE 2960 208 2960 80
WIRE 3104 208 3104 112
WIRE 3104 208 2960 208
WIRE 3376 208 3376 128
WIRE 3376 208 3104 208
WIRE 3984 208 3984 144
WIRE 3984 208 3376 208
WIRE 4032 208 3984 208
WIRE 2176 224 2176 208
WIRE 2176 224 2128 224
WIRE 2352 224 2352 208
WIRE 2896 224 2896 208
WIRE 3984 224 3984 208
WIRE 2656 240 2656 208
WIRE 1936 288 1936 272
WIRE 3984 320 3984 304
WIRE 2352 336 2352 288
WIRE 2656 352 2656 320
WIRE 1936 384 1936 368
WIRE 2896 416 2896 304
WIRE 3504 416 3504 368
WIRE 2176 432 2176 224
WIRE 2752 448 2752 96
WIRE 3232 480 3232 400
WIRE 2016 496 1872 496
WIRE 2480 528 2336 528
WIRE 2704 528 2560 528
WIRE 3312 528 3312 480
WIRE 3328 528 3312 528
WIRE 3232 544 3232 480
WIRE 3504 544 3504 496
WIRE 2752 560 2752 544
WIRE 3312 560 3312 528
WIRE 3312 560 3264 560
WIRE 3136 576 3072 576
WIRE 3200 576 3136 576
WIRE 3280 592 3264 592
WIRE 1760 624 1728 624
WIRE 1872 624 1760 624
WIRE 2016 624 1872 624
WIRE 3280 624 3280 592
WIRE 3328 624 3280 624
WIRE 3504 624 3408 624
WIRE 1760 640 1760 624
WIRE 1872 640 1872 624
WIRE 2512 656 2336 656
WIRE 2544 656 2512 656
WIRE 2672 656 2624 656
WIRE 3504 656 3504 624
WIRE 4064 656 3872 656
WIRE 4176 656 4144 656
WIRE 2672 672 2672 656
WIRE 2752 672 2752 640
WIRE 2016 688 1968 688
WIRE 3136 704 3136 576
WIRE 3168 704 3136 704
WIRE 3280 704 3280 624
WIRE 3280 704 3248 704
WIRE 3712 704 3568 704
WIRE 1872 720 1872 704
WIRE 2512 720 2512 656
WIRE 3872 720 3872 656
WIRE 3712 736 3712 704
WIRE 1760 752 1760 720
WIRE 1968 752 1968 688
WIRE 1968 752 1760 752
WIRE 1760 768 1760 752
WIRE 2672 768 2672 752
WIRE 2752 768 2752 752
WIRE 2176 800 2176 752
WIRE 2512 816 2512 800
WIRE 1760 848 1760 832
WIRE 3504 848 3504 752
WIRE 3712 848 3712 816
WIRE 3872 848 3872 784
WIRE 4064 848 3872 848
FLAG 2752 768 0
FLAG 1760 848 0
FLAG 1872 720 0
FLAG 2176 800 0
FLAG 2896 416 0
FLAG 2016 32 0
FLAG 4032 -16 Vout+
FLAG 2016 -80 IN
FLAG 2368 112 0
FLAG 2352 336 0
FLAG 3984 320 0
FLAG 2672 768 0
FLAG 2512 816 0
FLAG 4032 208 Vout-
FLAG 2128 224 Vcc
FLAG 1728 624 Vref
FLAG 2656 352 0
FLAG 4064 848 Vout-
FLAG 4176 656 Vout+
FLAG 3712 848 0
FLAG 3504 848 0
FLAG 3232 400 0
FLAG 3072 576 Vfb
FLAG 3232 608 Vcc
FLAG 1936 384 0
FLAG 1936 272 5V
FLAG 3504 368 5V
FLAG 3408 528 5V
FLAG 1872 496 0
SYMBOL RES 2736 656 R0
SYMATTR InstName R_acs712
SYMATTR Value 0.0012
SYMBOL cap 1744 768 R0
SYMATTR InstName C1
SYMATTR Value 1.1n
SYMBOL cap 1856 640 R0
WINDOW 39 24 84 Left 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMATTR SpiceLine IC=0
SYMBOL res 1744 624 R0
SYMATTR InstName R3
SYMATTR Value 15k
SYMBOL NMOS 2704 448 R0
SYMATTR InstName Q1
SYMATTR Value IRFZ48N
SYMBOL schottky 2544 192 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value BAT54
SYMBOL ind2 2976 -16 M0
WINDOW 0 1 32 Right 2
WINDOW 3 -1 70 Right 2
SYMATTR InstName L1
SYMATTR Value 20.94µ
SYMATTR SpiceLine Rser=0 Rpar=0
SYMBOL ind2 2880 208 R0
WINDOW 0 -4 44 Right 2
WINDOW 3 -6 73 Right 2
SYMATTR InstName L2
SYMATTR Value 10µH
SYMATTR Value2 Rser=.1
SYMBOL ind2 2880 96 M180
WINDOW 0 -2 87 Right 2
WINDOW 3 -3 43 Right 2
SYMATTR InstName L3
SYMATTR Value 20.94µ
SYMATTR SpiceLine Rser=0 Rpar=0
SYMBOL schottky 3200 -32 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value MBRS340
SYMBOL VOLTAGE 2016 -80 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 40
SYMBOL res 2160 -32 R0
SYMATTR InstName R13
SYMATTR Value 2k
SYMBOL PowerProducts\\LT1243 2176 592 R0
SYMATTR InstName U2
SYMBOL res 2576 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 12
SYMBOL res 2352 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 2k
SYMBOL cap 2336 224 R0
WINDOW 39 24 84 Left 2
SYMATTR InstName C7
SYMATTR Value 2.2µF
SYMATTR SpiceLine IC=8.5
SYMBOL cap 3360 64 R0
WINDOW 39 24 84 Left 2
SYMATTR InstName C8
SYMATTR Value 47µ
SYMATTR SpiceLine IC=12V
SYMBOL res 3968 208 R0
SYMATTR InstName R8
SYMATTR Value 1000k
SYMBOL res 2640 640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 3.5k
SYMBOL bv 2672 656 R0
WINDOW 3 -199 257 Left 2
SYMATTR Value V=2.5+0.083*I(R_acs712)
SYMATTR InstName B1
SYMBOL res 2496 704 R0
SYMATTR InstName R10
SYMATTR Value 1.5k
SYMBOL res 2640 224 R0
SYMATTR InstName R14
SYMATTR Value 100k
SYMBOL LED 3856 720 R0
SYMATTR InstName opto
SYMBOL res 4160 640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 50k
SYMBOL npn 3568 656 M0
SYMATTR InstName Q2
SYMATTR Value BC547B
SYMBOL res 3488 528 R0
SYMATTR InstName R9
SYMATTR Value 7k
SYMBOL bi 3712 816 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -47 -83 VRight 2
SYMATTR InstName B2
SYMATTR Value I=I(opto)*CTR
SYMBOL OpAmps\\UniversalOpAmp2 3232 576 R180
SYMATTR InstName U1
SYMBOL res 3424 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 100k
SYMBOL res 3424 608 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 100k
SYMBOL res 3264 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100k
SYMBOL res 3216 496 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R15
SYMATTR Value 100k
SYMBOL res 2736 544 R0
SYMATTR InstName R17
SYMATTR Value 0.01
SYMBOL res 3488 400 R0
SYMATTR InstName R18
SYMATTR Value 1
SYMBOL voltage 1936 272 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5V
SYMBOL schottky 2752 112 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value MBRS340
SYMBOL cap 2544 -16 R0
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res 2624 -48 R0
SYMATTR InstName R22
SYMATTR Value 1k
SYMBOL res 3968 48 R0
SYMATTR InstName R19
SYMATTR Value 5
SYMBOL res 3088 16 R0
SYMATTR InstName R2
SYMATTR Value 100k
TEXT 2936 -24 Bottom 2 !K1 L1 L2 L3 0.99
TEXT 1664 872 Left 2 !.tran 1.5m
TEXT 3800 608 Left 2 !.param CTR=0.005
TEXT 3800 576 Left 2 !.param Q_beta=100
TEXT 2832 584 Left 2 ;damper
LINE Normal 2928 400 2928 0 2
