Version 4
SHEET 1 5945676 13421556
WIRE 2432 -768 1296 -768
WIRE 1392 -656 1392 -672
WIRE 1392 -560 1392 -576
WIRE 1296 -464 1296 -768
WIRE 2432 -464 2432 -768
WIRE 2432 -464 1296 -464
WIRE 2112 -432 1296 -432
WIRE 3296 -400 2816 -400
WIRE 3216 -320 2912 -320
WIRE 1296 -304 1296 -432
WIRE 2112 -304 2112 -432
WIRE 2112 -304 1296 -304
WIRE 3584 -288 3312 -288
WIRE 3136 -272 3024 -272
WIRE 3024 -240 3024 -272
WIRE 3136 -240 3136 -272
WIRE 3360 -192 3328 -192
WIRE 3440 -192 3424 -192
WIRE 3552 -192 3520 -192
WIRE 1712 -160 1280 -160
WIRE 4496 -160 4240 -160
WIRE 4112 -144 3632 -144
WIRE 2416 -128 1872 -128
WIRE 3024 -128 3024 -160
WIRE 3136 -128 3136 -160
WIRE 3136 -128 3024 -128
WIRE 3312 -128 3312 -288
WIRE 3584 -128 3584 -288
WIRE 3584 -128 3312 -128
WIRE 2912 -112 2912 -320
WIRE 3216 -112 3216 -320
WIRE 3216 -112 2912 -112
WIRE 1472 -64 1360 -64
WIRE 1584 -64 1552 -64
WIRE 1808 -64 1664 -64
WIRE 1888 -64 1808 -64
WIRE 1984 -64 1968 -64
WIRE 2256 -64 2064 -64
WIRE 2480 -64 2256 -64
WIRE 2944 -64 2480 -64
WIRE 3040 -64 3024 -64
WIRE 3136 -64 3104 -64
WIRE 3328 -64 3328 -192
WIRE 3328 -64 3216 -64
WIRE 3408 -64 3328 -64
WIRE 3552 -64 3552 -192
WIRE 3552 -64 3472 -64
WIRE 3680 -64 3552 -64
WIRE 3776 -64 3680 -64
WIRE 3840 -64 3776 -64
WIRE 3984 -64 3920 -64
WIRE 4288 -64 4064 -64
WIRE 4336 -64 4288 -64
WIRE 1360 -48 1360 -64
WIRE 2256 -48 2256 -64
WIRE 2256 -48 2176 -48
WIRE 2320 -48 2256 -48
WIRE 2176 -32 2176 -48
WIRE 2320 -32 2320 -48
WIRE 3680 -32 3680 -64
WIRE 3776 -32 3776 -64
WIRE 2784 0 2464 0
WIRE 1808 16 1808 -64
WIRE 3040 16 3040 -64
WIRE 3104 16 3104 -64
WIRE 4208 16 4208 0
WIRE 4288 16 4288 -64
WIRE 2576 48 2544 48
WIRE 2672 48 2640 48
WIRE 3680 64 3680 48
WIRE 3776 64 3776 48
WIRE 2480 80 2480 -64
WIRE 2544 80 2544 48
WIRE 2544 80 2480 80
WIRE 2672 80 2672 48
WIRE 2688 80 2672 80
WIRE 1280 112 1280 -160
WIRE 1712 112 1712 -160
WIRE 1712 112 1280 112
WIRE 2176 128 2176 112
WIRE 2256 128 2176 128
WIRE 2320 128 2320 112
WIRE 2320 128 2256 128
WIRE 2544 128 2544 80
WIRE 2576 128 2544 128
WIRE 2672 128 2672 80
WIRE 2672 128 2656 128
WIRE 1360 144 1360 32
WIRE 2256 144 2256 128
WIRE 2752 176 2752 80
WIRE 3040 176 3040 96
WIRE 3040 176 2752 176
WIRE 3104 176 3104 96
WIRE 3680 176 3680 128
WIRE 3680 176 3104 176
WIRE 3776 176 3776 128
WIRE 3776 176 3680 176
WIRE 4208 176 4208 160
WIRE 4208 176 3776 176
WIRE 4288 176 4288 96
WIRE 4288 176 4208 176
WIRE 4336 176 4288 176
WIRE 1872 192 1872 -128
WIRE 2416 192 2416 -128
WIRE 2416 192 1872 192
WIRE 3632 192 3632 -144
WIRE 4112 192 4112 -144
WIRE 4112 192 3632 192
WIRE 2816 208 2816 -400
WIRE 3296 208 3296 -400
WIRE 3296 208 2816 208
WIRE 2464 224 2464 0
WIRE 2784 224 2784 0
WIRE 2784 224 2464 224
WIRE 4240 256 4240 -160
WIRE 4496 256 4496 -160
WIRE 4496 256 4240 256
WIRE 4496 288 3472 288
WIRE 2448 320 1520 320
WIRE 2112 368 1872 368
WIRE 2320 368 2112 368
WIRE 3920 384 3824 384
WIRE 4144 384 4112 384
WIRE 4272 384 4224 384
WIRE 1872 448 1872 416
WIRE 2752 448 2752 176
WIRE 2976 448 2752 448
WIRE 2112 464 2112 368
WIRE 1872 480 1872 448
WIRE 2752 480 2752 448
WIRE 2976 480 2976 448
WIRE 3888 480 3728 480
WIRE 3920 480 3888 480
WIRE 4144 480 4112 480
WIRE 4272 480 4208 480
WIRE 1680 528 1648 528
WIRE 1952 528 1680 528
WIRE 3888 528 3888 480
WIRE 1760 560 1712 560
WIRE 1872 560 1840 560
WIRE 2512 560 2272 560
WIRE 2656 560 2592 560
WIRE 2704 560 2656 560
WIRE 3728 560 3728 480
WIRE 1680 592 1680 528
WIRE 1712 592 1712 560
WIRE 1712 592 1680 592
WIRE 1872 592 1872 560
WIRE 1952 592 1872 592
WIRE 2656 608 2656 560
WIRE 2928 608 2928 560
WIRE 2928 608 2656 608
WIRE 1712 624 1712 592
WIRE 1760 624 1712 624
WIRE 1872 624 1872 592
WIRE 1872 624 1824 624
WIRE 1696 656 1664 656
WIRE 1808 656 1696 656
WIRE 1952 656 1808 656
WIRE 2752 656 2752 576
WIRE 2976 656 2976 576
WIRE 2976 656 2752 656
WIRE 3728 656 3728 640
WIRE 3728 656 3664 656
WIRE 1696 672 1696 656
WIRE 1808 672 1808 656
WIRE 2752 688 2752 656
WIRE 2752 688 2272 688
WIRE 3888 688 3888 608
WIRE 1952 720 1904 720
WIRE 1808 752 1808 736
WIRE 2752 752 2752 688
WIRE 3728 752 3728 736
WIRE 1696 784 1696 752
WIRE 1904 784 1904 720
WIRE 1904 784 1696 784
WIRE 2752 784 2752 752
WIRE 1696 800 1696 784
WIRE 3728 848 3728 832
WIRE 3472 880 3472 288
WIRE 4496 880 4496 288
WIRE 4496 880 3472 880
WIRE 1696 912 1696 864
WIRE 2112 912 2112 784
WIRE 2112 912 1696 912
WIRE 2752 944 2752 864
WIRE 2112 960 2112 912
WIRE 1520 1056 1520 320
WIRE 2448 1056 2448 320
WIRE 2448 1056 1520 1056
WIRE 2112 1088 2112 960
FLAG 2752 944 0
FLAG 1808 752 0
FLAG 1360 144 0
FLAG 4336 176 Vout_minus
FLAG 2320 368 Vcc
FLAG 1664 656 Vref
FLAG 4272 384 Vout_plus
FLAG 1648 528 Vfb
FLAG 1392 -560 0
FLAG 1392 -672 P_in
FLAG 4208 0 0
FLAG 1808 16 V_input_circuit
FLAG 2112 1088 0
FLAG 4272 480 Vout_minus
FLAG 3888 688 0
FLAG 2752 752 Vshunt
FLAG 3664 656 Vfb
FLAG 3728 848 0
FLAG 3824 384 Vref
FLAG 2256 144 0
FLAG 1872 480 0
FLAG 4336 -64 Vout_plus
FLAG 2112 960 0
SYMBOL cap 1680 800 R0
SYMATTR InstName Ct
SYMATTR Value 1.1n
SYMBOL cap 1792 672 R0
WINDOW 39 24 84 Left 2
SYMATTR SpiceLine IC=0
SYMATTR InstName C2
SYMATTR Value 220n
SYMBOL res 1680 656 R0
SYMATTR InstName Rt
SYMATTR Value 15k
SYMBOL ind2 3120 0 M0
WINDOW 0 1 32 Right 2
WINDOW 3 -1 70 Right 2
SYMATTR InstName L1
SYMATTR Value 20.94µ
SYMATTR SpiceLine Rser=0 Rpar=0
SYMBOL ind2 3024 112 M180
WINDOW 0 -2 87 Right 2
WINDOW 3 -3 43 Right 2
SYMATTR InstName L3
SYMATTR Value 20.94µ
SYMATTR SpiceLine Rser=0 Rpar=0
SYMBOL schottky 3408 -80 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value MBR735
SYMBOL VOLTAGE 1360 -64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName source
SYMATTR Value {Vin}
SYMBOL PowerProducts\\LT1243 2112 624 R0
SYMATTR InstName U2
SYMBOL res 2608 544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 6
SYMBOL schottky 2752 96 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value MBRS340
SYMBOL cap 2640 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 30 27 VTop 2
SYMATTR InstName C3
SYMATTR Value 660n
SYMBOL res 2672 112 R90
WINDOW 0 6 63 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 330
SYMBOL res 3040 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 4.6m
SYMBOL ind2 3040 -144 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L4
SYMATTR Value 20.94µ
SYMATTR Type ind
SYMBOL res 3120 -256 R0
SYMATTR InstName R2
SYMATTR Value 150
SYMBOL res 3232 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 4.6m
SYMBOL cap 2304 48 R0
SYMATTR SpiceLine IC={Vin}
SYMATTR InstName C11
SYMATTR Value 470µ
SYMBOL ind 1568 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L7
SYMATTR Value 25nH
SYMBOL bv 1392 -672 R0
SYMATTR InstName B3
SYMATTR Value V=-{V(V_input_circuit)}*I(source)
SYMBOL cap 3424 -208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C13
SYMATTR Value 1nF
SYMBOL res 3536 -208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 43
SYMBOL cap 2160 48 R0
SYMATTR InstName C14
SYMATTR Value 660n
SYMBOL res 1568 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R33
SYMATTR Value 0.1
SYMBOL ind 1872 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L11
SYMATTR Value 10µ
SYMBOL res 2080 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 2m
SYMBOL Optos\\PC817A 4016 432 M0
SYMATTR InstName U1
SYMBOL zener 4208 464 R90
WINDOW 0 -4 32 VBottom 2
WINDOW 3 36 32 VTop 2
SYMATTR InstName D1
SYMATTR Value TDZV10
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 4240 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1.2k
SYMBOL res 3872 512 R0
SYMATTR InstName R7
SYMATTR Value 2k
SYMBOL voltage 1872 352 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 -3 0 Left 2
SYMATTR InstName Buck-converter
SYMATTR Value 15
SYMBOL res 2736 768 R0
SYMATTR InstName R1
SYMATTR Value 65m
SYMBOL res 3712 544 R0
WINDOW 3 -116 53 Left 1
SYMATTR InstName Rpot3
SYMATTR Value {2000*T_POT}
SYMBOL res 3712 640 R0
WINDOW 0 38 57 Left 2
WINDOW 3 -142 56 Left 1
SYMATTR InstName Rpot4
SYMATTR Value {2000*(1-T_POT)}
SYMBOL res 3712 736 R0
SYMATTR InstName R9
SYMATTR Value 5.7k
SYMBOL cap 4224 80 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C4
SYMATTR Value 1n
SYMBOL res 4224 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R18
SYMATTR Value 1k
SYMBOL res 1856 544 R90
WINDOW 0 13 128 VBottom 2
WINDOW 3 -13 16 VTop 2
SYMATTR InstName Rcomp
SYMATTR Value 10k
SYMBOL cap 1824 608 R90
WINDOW 0 37 78 VBottom 2
WINDOW 3 13 -1 VTop 2
SYMATTR InstName Ccomp
SYMATTR Value 10n
SYMBOL ind 3824 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 10µ
SYMBOL res 4080 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 2m
SYMBOL res 4272 0 R0
SYMATTR InstName Rout
SYMATTR Value 2.81
SYMBOL cap 3664 64 R0
WINDOW 39 24 84 Left 2
SYMATTR InstName C6
SYMATTR Value 660n
SYMATTR SpiceLine IC=12.5
SYMBOL cap 3760 64 R0
WINDOW 39 24 84 Left 2
SYMATTR InstName C7
SYMATTR Value 940µ
SYMATTR SpiceLine IC=12.5
SYMBOL NMOS 2928 480 R0
SYMATTR InstName Q2
SYMATTR Value AONR32320C
SYMBOL NMOS 2704 480 R0
SYMATTR InstName Q1
SYMATTR Value AONR32320C
SYMBOL res 2304 -48 R0
SYMATTR InstName R10
SYMATTR Value 0.2
SYMBOL res 2160 -48 R0
SYMATTR InstName R11
SYMATTR Value 0.02
SYMBOL res 3760 -48 R0
SYMATTR InstName R12
SYMATTR Value 0.1
SYMBOL res 3664 -48 R0
SYMATTR InstName R14
SYMATTR Value 0.02
TEXT 3064 -328 Bottom 2 !K1 L1 L3 L4 0.99
TEXT 2992 -296 Left 2 ;Core loss model
TEXT 1320 -360 Left 2 !.param Vin=20
TEXT 1288 -144 Left 2 ;Feeder model
TEXT 1312 -408 Left 4 ;Parameters
TEXT 1288 -880 Left 2 ;Snubber design: Lecture 8.7: The Flyback Converter 4 (RCD Snubber)\nhttps://youtu.be/WQtO3i5ZG74\nR_snubber = (Vsnubber*(Vsnubber-Vo/N)) / (0.5*(I_Lpeak^2)*L_leak*f_sw)\nC_snubber = Does not matter at steady state if ideal model is assumed. Better to pick a value resulting in <%3 ripple
TEXT 3648 -128 Left 2 ;Output filter 16V/10A rated
TEXT 1960 -160 Left 2 ;Input Filter 60V/10A rated
TEXT 1528 336 Left 2 ;CONTROLLER IC
TEXT 4264 -136 Left 2 ;LOAD
TEXT 2488 8 Left 2 ;Snubber
TEXT 3328 -272 Left 2 ;Diode Snubber
TEXT 2824 -384 Left 2 ;Transformer Model
TEXT 1520 1080 Left 2 !.tran 0 5m 0m uic
TEXT 1320 -336 Left 2 !.param T_POT=0.0001
TEXT 3488 304 Left 2 ;Optocoupler feedback circuit
LINE Normal 3072 192 3072 -96 2
