Version 4
SHEET 1 5945676 13421556
WIRE 2384 -768 1248 -768
WIRE 1344 -656 1344 -672
WIRE 1344 -560 1344 -576
WIRE 1248 -464 1248 -768
WIRE 2384 -464 2384 -768
WIRE 2384 -464 1248 -464
WIRE 2064 -432 1248 -432
WIRE 3296 -400 2816 -400
WIRE 3216 -320 2912 -320
WIRE 1248 -304 1248 -432
WIRE 2064 -304 2064 -432
WIRE 2064 -304 1248 -304
WIRE 3584 -288 3312 -288
WIRE 3136 -272 3024 -272
WIRE 3024 -240 3024 -272
WIRE 3136 -240 3136 -272
WIRE 3360 -192 3328 -192
WIRE 3440 -192 3424 -192
WIRE 3552 -192 3520 -192
WIRE 1664 -160 1232 -160
WIRE 4496 -160 4240 -160
WIRE 4112 -144 3632 -144
WIRE 2368 -128 1824 -128
WIRE 3024 -128 3024 -160
WIRE 3136 -128 3136 -160
WIRE 3136 -128 3024 -128
WIRE 3312 -128 3312 -288
WIRE 3584 -128 3584 -288
WIRE 3584 -128 3312 -128
WIRE 2912 -112 2912 -320
WIRE 3216 -112 3216 -320
WIRE 3216 -112 2912 -112
WIRE 1424 -64 1312 -64
WIRE 1536 -64 1504 -64
WIRE 1760 -64 1616 -64
WIRE 1840 -64 1760 -64
WIRE 1936 -64 1920 -64
WIRE 2208 -64 2016 -64
WIRE 2480 -64 2208 -64
WIRE 2944 -64 2480 -64
WIRE 3040 -64 3024 -64
WIRE 3136 -64 3104 -64
WIRE 3328 -64 3328 -192
WIRE 3328 -64 3216 -64
WIRE 3408 -64 3328 -64
WIRE 3552 -64 3552 -192
WIRE 3552 -64 3472 -64
WIRE 3680 -64 3552 -64
WIRE 3776 -64 3680 -64
WIRE 3840 -64 3776 -64
WIRE 3984 -64 3920 -64
WIRE 4288 -64 4064 -64
WIRE 4336 -64 4288 -64
WIRE 1312 -48 1312 -64
WIRE 2208 -48 2208 -64
WIRE 2208 -48 2128 -48
WIRE 2272 -48 2208 -48
WIRE 2128 0 2128 -48
WIRE 2272 0 2272 -48
WIRE 2800 0 2464 0
WIRE 3680 0 3680 -64
WIRE 3776 0 3776 -64
WIRE 1760 16 1760 -64
WIRE 3040 16 3040 -64
WIRE 3104 16 3104 -64
WIRE 4208 16 4208 0
WIRE 4288 16 4288 -64
WIRE 2576 48 2544 48
WIRE 2672 48 2640 48
WIRE 2480 80 2480 -64
WIRE 2544 80 2544 48
WIRE 2544 80 2480 80
WIRE 2672 80 2672 48
WIRE 2688 80 2672 80
WIRE 1232 112 1232 -160
WIRE 1664 112 1664 -160
WIRE 1664 112 1232 112
WIRE 2128 128 2128 64
WIRE 2208 128 2128 128
WIRE 2272 128 2272 64
WIRE 2272 128 2208 128
WIRE 2544 128 2544 80
WIRE 2576 128 2544 128
WIRE 2672 128 2672 80
WIRE 2672 128 2656 128
WIRE 1312 144 1312 32
WIRE 2208 144 2208 128
WIRE 2752 176 2752 80
WIRE 3040 176 3040 96
WIRE 3040 176 2752 176
WIRE 3104 176 3104 96
WIRE 3680 176 3680 64
WIRE 3680 176 3104 176
WIRE 3776 176 3776 64
WIRE 3776 176 3680 176
WIRE 4208 176 4208 160
WIRE 4208 176 3776 176
WIRE 4288 176 4288 96
WIRE 4288 176 4208 176
WIRE 4336 176 4288 176
WIRE 1824 192 1824 -128
WIRE 2368 192 2368 -128
WIRE 2368 192 1824 192
WIRE 3632 192 3632 -144
WIRE 4112 192 4112 -144
WIRE 4112 192 3632 192
WIRE 2464 224 2464 0
WIRE 2800 224 2800 0
WIRE 2800 224 2464 224
WIRE 4240 256 4240 -160
WIRE 4496 256 4496 -160
WIRE 4496 256 4240 256
WIRE 4496 288 3472 288
WIRE 3920 384 3824 384
WIRE 4144 384 4112 384
WIRE 4272 384 4224 384
WIRE 2816 416 2816 -400
WIRE 3296 416 3296 -400
WIRE 3296 416 2816 416
WIRE 2352 464 1232 464
WIRE 3888 480 3792 480
WIRE 3920 480 3888 480
WIRE 4144 480 4112 480
WIRE 4272 480 4208 480
WIRE 2848 496 2656 496
WIRE 1728 512 1664 512
WIRE 2016 512 1808 512
WIRE 2224 512 2016 512
WIRE 3888 528 3888 480
WIRE 3792 560 3792 480
WIRE 2016 608 2016 512
WIRE 2752 624 2752 176
WIRE 3792 656 3792 640
WIRE 3792 656 3728 656
WIRE 1584 672 1552 672
WIRE 1856 672 1584 672
WIRE 3888 688 3888 608
WIRE 1664 704 1616 704
WIRE 1776 704 1744 704
WIRE 2416 704 2176 704
WIRE 2704 704 2496 704
WIRE 1376 720 1376 704
WIRE 1584 736 1584 672
WIRE 1616 736 1616 704
WIRE 1616 736 1584 736
WIRE 1776 736 1776 704
WIRE 1856 736 1776 736
WIRE 3792 752 3792 736
WIRE 1616 768 1616 736
WIRE 1664 768 1616 768
WIRE 1776 768 1776 736
WIRE 1776 768 1728 768
WIRE 1600 800 1568 800
WIRE 1712 800 1600 800
WIRE 1856 800 1712 800
WIRE 1376 816 1376 800
WIRE 1600 816 1600 800
WIRE 1712 816 1712 800
WIRE 2592 832 2176 832
WIRE 3792 848 3792 832
WIRE 1856 864 1808 864
WIRE 2656 864 2656 496
WIRE 2848 864 2848 496
WIRE 2848 864 2656 864
WIRE 3472 880 3472 288
WIRE 4496 880 4496 288
WIRE 4496 880 3472 880
WIRE 1712 896 1712 880
WIRE 1600 928 1600 896
WIRE 1808 928 1808 864
WIRE 1808 928 1600 928
WIRE 2592 928 2592 832
WIRE 2752 928 2752 720
WIRE 2752 928 2592 928
WIRE 1600 944 1600 928
WIRE 2752 1008 2752 928
WIRE 2752 1040 2752 1008
WIRE 1600 1184 1600 1008
WIRE 2016 1184 2016 928
WIRE 2016 1184 1600 1184
WIRE 1232 1200 1232 464
WIRE 2352 1200 2352 464
WIRE 2352 1200 1232 1200
WIRE 2752 1200 2752 1120
WIRE 2016 1232 2016 1184
FLAG 2752 1200 0
FLAG 1712 896 0
FLAG 1312 144 0
FLAG 4336 176 Vout_minus
FLAG 2224 512 Vcc
FLAG 1568 800 Vref
FLAG 4272 384 Vout_plus
FLAG 1376 816 0
FLAG 1376 704 5V
FLAG 1552 672 Vfb
FLAG 1344 -560 0
FLAG 1344 -672 P_in
FLAG 4208 0 0
FLAG 1760 16 V_input_circuit
FLAG 2016 1232 0
FLAG 4272 480 Vout_minus
FLAG 3888 688 0
FLAG 2592 832 sense
FLAG 2752 1008 Vshunt
FLAG 3728 656 Vfb
FLAG 3792 848 0
FLAG 3824 384 Vref
FLAG 2208 144 0
FLAG 1664 512 0
FLAG 4336 -64 Vout_plus
SYMBOL cap 1584 944 R0
SYMATTR InstName C1
SYMATTR Value 1.1n
SYMBOL cap 1696 816 R0
WINDOW 39 24 84 Left 2
SYMATTR SpiceLine IC=0
SYMATTR InstName C2
SYMATTR Value 220n
SYMBOL res 1584 800 R0
SYMATTR InstName R3
SYMATTR Value 15k
SYMBOL NMOS 2704 624 R0
SYMATTR InstName Q1
SYMATTR Value Si1555DL_N
SYMBOL ind2 3120 0 M0
WINDOW 0 1 32 Right 2
WINDOW 3 -1 70 Right 2
SYMATTR InstName L1
SYMATTR Value 20.94µ
SYMATTR SpiceLine Rser=0 Rpar=0
SYMBOL ind2 3024 112 M180
WINDOW 0 -2 87 Right 2
WINDOW 3 -3 43 Right 2
SYMATTR InstName L3
SYMATTR Value 20.94µ
SYMATTR SpiceLine Rser=0 Rpar=0
SYMBOL schottky 3408 -80 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value MBR735
SYMBOL VOLTAGE 1312 -64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName source
SYMATTR Value {Vin}
SYMBOL PowerProducts\\LT1243 2016 768 R0
SYMATTR InstName U2
SYMBOL res 2512 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 12
SYMBOL voltage 1376 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5V
SYMBOL schottky 2752 96 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value MBRS340
SYMBOL cap 2640 32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 660n
SYMBOL res 2672 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 330
SYMBOL res 3040 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 4.6m
SYMBOL ind2 3040 -144 R180
WINDOW 0 36 80 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName L4
SYMATTR Value 20.94µ
SYMATTR Type ind
SYMBOL res 3120 -256 R0
SYMATTR InstName R2
SYMATTR Value 150
SYMBOL res 3232 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 4.6m
SYMBOL cap 2256 0 R0
SYMATTR SpiceLine IC={Vin}
SYMATTR InstName C11
SYMATTR Value 470µ
SYMBOL ind 1520 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L7
SYMATTR Value 25nH
SYMBOL bv 1344 -672 R0
SYMATTR InstName B3
SYMATTR Value V=-{V(V_input_circuit)}*I(source)
SYMBOL cap 3424 -208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C13
SYMATTR Value 1nF
SYMBOL res 3536 -208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 43
SYMBOL cap 2112 0 R0
SYMATTR InstName C14
SYMATTR Value 660n
SYMBOL res 1520 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R33
SYMATTR Value 0.05
SYMBOL ind 1824 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L11
SYMATTR Value 10µ
SYMBOL res 2032 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 2m
SYMBOL Optos\\PC817A 4016 432 M0
SYMATTR InstName U1
SYMBOL zener 4208 464 R90
WINDOW 0 -4 32 VBottom 2
WINDOW 3 36 32 VTop 2
SYMATTR InstName D1
SYMATTR Value TDZV10
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 4240 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1.2k
SYMBOL res 3872 512 R0
SYMATTR InstName R7
SYMATTR Value 2k
SYMBOL voltage 1824 512 R90
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL res 2736 1024 R0
SYMATTR InstName R1
SYMATTR Value 65m
SYMBOL res 3776 544 R0
WINDOW 3 -182 25 Left 2
SYMATTR InstName R13
SYMATTR Value {2000*T_POT}
SYMBOL res 3776 640 R0
WINDOW 3 -227 54 Left 2
SYMATTR InstName R15
SYMATTR Value {2000*(1-T_POT)}
SYMBOL res 3776 736 R0
SYMATTR InstName R9
SYMATTR Value 2.7k
SYMBOL cap 4224 80 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C4
SYMATTR Value 1n
SYMBOL res 4224 176 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R18
SYMATTR Value 1k
SYMBOL res 1760 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 10k
SYMBOL cap 1728 752 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 10n
SYMBOL ind 3824 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 10µ
SYMBOL res 4080 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 2m
SYMBOL res 4272 0 R0
SYMATTR InstName Rout
SYMATTR Value 2.4
SYMBOL cap 3664 0 R0
WINDOW 39 24 84 Left 2
SYMATTR InstName C6
SYMATTR Value 660n
SYMATTR SpiceLine IC=12.5
SYMBOL cap 3760 0 R0
WINDOW 39 24 84 Left 2
SYMATTR InstName C7
SYMATTR Value 940µ
SYMATTR SpiceLine IC=12.5
TEXT 3064 -328 Bottom 2 !K1 L1 L3 L4 0.99
TEXT 2992 -296 Left 2 ;Core loss model
TEXT 1272 -360 Left 2 !.param Vin=40
TEXT 1240 -144 Left 2 ;Feeder model
TEXT 1264 -408 Left 4 ;Parameters
TEXT 1248 -888 Left 2 ;Snubber design: Lecture 8.7: The Flyback Converter 4 (RCD Snubber)\nhttps://youtu.be/WQtO3i5ZG74\nR_snubber = (Vsnubber*(Vsnubber-Vo/N)) / (0.5*(I_Lpeak^2)*L_leak*f_sw)\nC_snubber = Does not matter at steady state if ideal model is assumed. Better to pick a value resulting in <%3 ripple
TEXT 2752 512 Left 2 ;MOSFET
TEXT 3648 -128 Left 2 ;Output filter 16V/10A rated
TEXT 1912 -160 Left 2 ;Input Filter 60V/10A rated
TEXT 1240 480 Left 2 ;CONTROLLER IC
TEXT 4264 -136 Left 2 ;LOAD
TEXT 2488 8 Left 2 ;Snubber
TEXT 3328 -272 Left 2 ;Diode Snubber
TEXT 2824 -384 Left 2 ;Transformer Model
TEXT 1232 1224 Left 2 !.tran 0 5m 0m uic
TEXT 1272 -336 Left 2 !.param T_POT=0.5
TEXT 3488 304 Left 2 ;Optocoupler feedback circuit
LINE Normal 3072 400 3072 -96 2
